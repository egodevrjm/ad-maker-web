<!DOCTYPE html>
<html>
<head>
    <title>Final Video Test</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 50px auto; padding: 20px; }
        .video-container { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        video { width: 100%; max-width: 600px; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Final Video Test</h1>
    
    <div class="video-container">
        <h2>Test Direct Video Access</h2>
        <p>Enter the video filename from outputs/final/</p>
        <input type="text" id="videoFile" placeholder="e.g., abc123.mp4" style="width: 300px; padding: 5px;">
        <button onclick="testVideo()">Test Video</button>
        <div id="result"></div>
        <video id="videoPlayer" controls style="display: none; margin-top: 20px;"></video>
    </div>
    
    <div class="video-container">
        <h2>List All Final Videos</h2>
        <button onclick="listVideos()">List Videos</button>
        <div id="videoList"></div>
    </div>
    
    <script>
        function testVideo() {
            const filename = document.getElementById('videoFile').value;
            if (!filename) {
                alert('Please enter a video filename');
                return;
            }
            
            const videoUrl = `http://localhost:8000/api/final/${filename}`;
            const video = document.getElementById('videoPlayer');
            const result = document.getElementById('result');
            
            video.src = videoUrl;
            video.style.display = 'block';
            
            video.onloadeddata = () => {
                result.innerHTML = '<p class="success">✅ Video loaded successfully!</p>';
                result.innerHTML += `<p>URL: ${videoUrl}</p>`;
                result.innerHTML += `<p>Duration: ${video.duration.toFixed(1)} seconds</p>`;
            };
            
            video.onerror = () => {
                result.innerHTML = '<p class="error">❌ Failed to load video</p>';
                result.innerHTML += `<p>Tried URL: ${videoUrl}</p>`;
            };
        }
        
        async function listVideos() {
            const listDiv = document.getElementById('videoList');
            listDiv.innerHTML = '<p>Note: You need to check backend-node/outputs/final/ directory manually</p>';
            listDiv.innerHTML += '<p>Common issues:</p>';
            listDiv.innerHTML += '<ul>';
            listDiv.innerHTML += '<li>Video exists but API returns 404 - check static file serving</li>';
            listDiv.innerHTML += '<li>Video has no audio - FAL.ai videos often have no audio track</li>';
            listDiv.innerHTML += '<li>Frontend shows placeholder - check console for actual URL</li>';
            listDiv.innerHTML += '</ul>';
        }
    </script>
</body>
</html>
